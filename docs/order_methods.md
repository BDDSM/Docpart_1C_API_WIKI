# Справочник состояний заказа и его позиций

Получение списка возможных состояний заказов и позиций заказов

Операция: **get_statuses_description**

Параметры запроса:

| **Параметр** | **Пример заполнения** | **Описание**
|---|---|---|
|tech_key *| TEST_KEY_FROM_SETTINGS | Строка – Ключ для вызова скриптов|
|orders |1|Булево, Если Истина, то в результат будет добавлен список состояний заказов|
|order_items|1|Булево, Если Истина, то в результат будет добавлен список состояний позиций заказов (товаров)|

В результате выполнения метода будет возвращена JSON-структура с полями:

|**Поле**|**Описание**|
|---|---|
|status| Булево – статус выполнения метода|
|message|Строка – всегда возвращает текст «ОК»|
|data|Запрашиваемые данные|При успешном выполнении метод возвращает данные \[data\]:|


|**Поле**|**Описание**|
|---|---|
|orders|Массив состояний заказа|
|order_items| Массив состояний позиций заказа (товаров)|


Структура массива состояний заказов - orders:

|**Поле**|**Описание**|
|---|---|
|id|Число, Идентификатор статуса|
|name|Строка, Наименование статуса|
|color|Строка, Цвет статуса на сайте|
|for_paid|Булево, Статус устанавливается для оплаченных заказов|
|for_created|Булево, статус устанавливается для новых заказов|
|order|Число, порядок сортировки|

Структура массива состояний заказов - order_items:

|**Поле**|**Описание**|
|---|---|
|id|Число, Идентификатор статуса позиции|
|name|Строка, Наименование статуса позиции|
|color|Строка, Цвет статуса позиции на сайте|
|count_flag|Булево, при установке статуса товар с наличия будет зарезервирован|
|issue_flag|Булево, при устанвоке статуса товар будет выдан покупателю|
|for_created|Булево, статус устанавливается для новых заказов|
|order|Число, порядок сортировки|



# Список заказов

Метод возвращает список заказов, соответствующих отбору.

Операция: **get_orders**

Параметры запроса:

|**Параметр** |**Пример заполнения** |**Описание** |
|---|---|---|
|tech_key *|TEST_KEY_FROM_SETTINGS|Строка – Ключ для вызова скриптов|
|time_from *|10.01.2019|Дата – Начало периода получения заказов|
|time_to|12.01.2019|Дата – Окончание периода получения заказов|
|order_id|10|Идентификатор заказа|
|status|2|Идентификатор статуса заказа|
|paid|1|Состояние оплаты заказа (0/1)|

Результат запроса представляет собой структуру с данными:

|**Поле** |**Описание** |
|---|---|
|status|Булево – статус выполнения метода|
|message|Строка – всегда возвращает текст «ОК»|
|data|Запрашиваемые данные|

При успешном выполнении метод возвращает данные [data]:

|**Поле** |**Описание** |
|---|---|
|order_id|Число – Идентификатор заказа|
|time|Дата  – Дата и время оформления заказа|
|user_id|Число – Идентификатор пользователя|
|amount|Число – Сумма заказа|
|paid|Число – Состояние оплаты (0/1)|
|status|Число – Идентификатор статуса заказа|
|obtain_id|Число – Идентификатор способа доставки|
|obtain_caption|Строка – Наименование способа доставки|
|office_id|Число – Идентификатор офиса самовывоза|
|office_name|Строка – Офис самовывоза|

# Список товаров заказа 

Метод возвращает список товаров для выбранных заказов

Операция: **get_orders_items**

Параметры запроса:

|**Параметр** |**Пример заполнения** |**Описание** |
|---|---|---|
|tech_key *|TEST_KEY_FROM_SETTINGS|Строка – Ключ для вызова скриптов|
|order_id|10|Число / массив чисел - Идентификаторы заказа|

Результат запроса представляет собой структуру с данными:

|**Поле** |**Описание** |
|---|---|
|status|Булево – статус выполнения метода|
|message|Строка – всегда возвращает текст «ОК»|
|data|Запрашиваемые данные|

При успешном выполнении метод возвращает данные [data]:

|**Поле** |**Описание** |
|---|---|
|order_id|Число – Идентификатор заказа|
|item_id|Число – Идентификатор позиции заказа|
|product_name|Строка – Наименование товара каталога. Для товара с product_type=1|
|brand|Строка – Наименование производителя|
|article|Строка – Артикул товара|
|count|Число – Количество|
|price|Число – Цена|
|amount|Число – Сумма|
|product_type|Число – Тип товара: 1 – Товар из каталога в наличии, 2 – Товар из проценки по артикулу|
|product_id|Число – Идентификатор товара каталога. Для товара с product_type=1|
|t2_time_to_exe|Дата – Срок доставки. Для товара с product_type=2|
|t2_time_to_exe_guaranteed|Дата – Гарантированный срок доставки. Для товара с product_type=2|
|status_id|Число – Идентификатор статуса позиции|
|status_name|Строка – Наименование статуса позиции|


# Изменение статуса заказа

Метод выполняет изменение статуса заказа или флага оплаты заказа. Возвращает переданную структуру с добавлением полей статус

Операция: **set_order_status**

Параметры запроса:

|**Параметр** |**Пример заполнения** |**Описание** |
|---|---|---|
|tech_key *|TEST_KEY_FROM_SETTINGS|Строка – Ключ для вызова скриптов|
|order_statuses| |Структура/массив с описанием статуса заказа|

Структура order_statuses представляет собой один элемент или массив элементов с полями:

|**Параметр** |**Пример заполнения** |**Описание** |
|---|---|---|
|order_id|12|Число – id заказа|
|status|1|Число – id статуса|
|paid|1|Флаг оплаты заказа: 1- оплачен|
|history|1|Флаг записи истории заказа: 1 – В историю заказа будет добавлено сообщение об изменении статуса заказа|
|manager_id|65|Число, id – менеджера интернет-магазина, от имени которого будет происходить изменение статуса. Можно узнать в панели управления Docpart, в разделе пользователи.|

Результат запроса представляет собой структуру с данными:

|**Поле** |**Тип** |**Описание** |
|---|---|---|
|status|Булево|Статус выполнения метода|
|message|Строка|Всегда возвращает текст «ОК»|
|data|Структура|Запрашиваемые данные|

При успешном выполнении метод возвращает данные [data]:

|**Поле** |**Описание** |
|---|---|
|order_id|Переданный параметр: id заказа|
|status|Переданный параметр: id статуса|
|paid|Переданный параметр: Флаг оплаты заказа|
|history|Переданный параметр: Флаг записи истории заказа|
|manager_id|Переданный параметр: id – менеджера интернет-магазина|
|result|Булево, Флаг изменения состояния|
|message|Строка, Описание ошибки изменения заказа, если result=false|

# Изменение статуса позиции заказа

Метод выполняет изменение статуса позиции заказа. Возвращает переданную структуру с добавлением полей результата выполнения.

Операция: **set_order_item_status:**

Параметры запроса:

|**Параметр** |**Пример заполнения** |**Описание** |
|---|---|---|
|tech_key *|TEST_KEY_FROM_SETTINGS|Строка – Ключ для вызова скриптов|
|item_statuses| |Структура/массив с описанием статуса заказа|

Структура item_statuses представляет собой элемент или массив элементов с полями:

|**Параметр** |**Пример заполнения** |**Описание** |
|---|---|---|
|item_id|12|Число – id позиции заказа|
|status|1|Число – id статуса|
|history|1|Флаг записи истории заказа: 1 – В историю заказа будет добавлено сообщение об изменении статуса позиции заказа|
|manager_id|65|Число, id – менеджера интернет-магазина, от имени которого будет происходить изменение статуса. Можно узнать в панели управления Docpart, в разделе пользователи.|

Результат запроса представляет собой структуру с данными:

|**Поле** |**Описание** |
|---|---|
|status|Булево – статус выполнения метода|
|message|Строка – всегда возвращает текст «ОК»|
|data|Запрашиваемые данные|

При успешном выполнении метод возвращает данные [data]:

|**Поле** |**Описание** |
|---|---|
|item_id|Переданный параметр: id позиции заказа|
|status|Переданный параметр: id статуса|
|history|Переданный параметр: Флаг записи истории заказа|
|manager_id|Переданный параметр: id – менеджера интернет-магазина|
|result|Булево, Флаг изменения состояния|
|message|Строка, Описание ошибки изменения заказа, если result=false|
